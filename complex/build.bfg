# -*- python -*-

#test_dirs = [...]
#tests = [...]




libmettle = library(
    'mettle',
    files=['libmettle.cpp', 'log/verbose.cpp'],
    libs=['boost_iostreams', 'boost_program_options']
)
mettle = executable('mettle', files=['mettle.cpp'], libs=[libmettle])

all_tests = ['test_foo', 'test_bar']

tests = target('tests', [executable(i, files=[i+'.cpp']) for i in all_tests])

target('all', [mettle, libmettle])
command('test', deps=[mettle, tests], cmd=['./mettle ' + ' '.join(all_tests)])
