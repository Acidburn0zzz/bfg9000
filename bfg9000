#!/usr/bin/env python
# -*- python -*-

import os.path
import sys

import builtins
import node
import builtin_rules
import utils

builddir = os.path.abspath(sys.argv[1])
bfgfile = 'build.bfg'

if len(sys.argv) > 2 and sys.argv[2] == 'ninja':
    import backends.ninja as backend
else:
    import backends.make as backend

execfile(os.path.join(builddir, bfgfile), builtins.all_builtins)
backend.write(builddir, node.all_targets)
