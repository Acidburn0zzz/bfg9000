<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">

	<title>Writing a Build File - bfg9000</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">
        <link href="../../css/extra.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">bfg9000</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Home</a>
                </li>
            
            
            
                <li >
                    <a href="../../install/">Installation</a>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../building/">Building with bfg9000</a>
                        </li>
                    
                        <li class="active">
                            <a href="./">Writing a Build File</a>
                        </li>
                    
                        <li >
                            <a href="../reference/">Reference</a>
                        </li>
                    
                        <li >
                            <a href="../environment-vars/">Environment Variables</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developer Guide <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../developer/internals/">Internals</a>
                        </li>
                    
                        <li >
                            <a href="../../developer/contributing/">Contributing</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li >
                    <a href="../../license/">License</a>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../building/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../reference/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/jimporter/bfg9000/">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#writing-a-build-file">Writing a Build File</a></li>
        
            <li><a href="#your-first-build-script">Your first build script</a></li>
        
            <li><a href="#building-executables">Building executables</a></li>
        
            <li><a href="#building-libraries">Building libraries</a></li>
        
            <li><a href="#default-build">Default build</a></li>
        
            <li><a href="#external-packages">External packages</a></li>
        
            <li><a href="#installation">Installation</a></li>
        
            <li><a href="#commands">Commands</a></li>
        
            <li><a href="#aliases">Aliases</a></li>
        
            <li><a href="#tests">Tests</a></li>
        
            <li><a href="#finding-files">Finding files</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="writing-a-build-file">Writing a Build File</h1>
<p>bfg9000's build script is called <code>build.bfg</code> and is (usually) placed in the root
of your source tree. <code>build.bfg</code> files are just Python scripts with a handful of
extra built-in functions to define all the rules for building your software.
While bfg9000's goal is to make writing build scripts easy, sometimes complexity
is unavoidable. By using a general-purpose language, this complexity can
(hopefully!) be managed.</p>
<h2 id="your-first-build-script">Your first build script</h2>
<p>The simplest build script, compiling a single source file into an
<a href="../reference/#executablename-files-extra_deps">executable</a>, is indeed very
simple:</p>
<pre><code class="python">executable('simple', files=['simple.cpp'])
</code></pre>

<p>The above is all you need to build your executable for any supported build
backend and platform. The output file's name is automatically converted to the
appropriate name for the target platform (<code>'simple'</code> on Linux and OS X and
<code>'simple.exe'</code> on Windows).</p>
<h2 id="building-executables">Building executables</h2>
<p>We've already seen how to build simple executables, but build tools aren't much
good if that's all they can do! Naturally, it's easy to build an executable from
multiple source files (just add more elements to the <em>files</em> argument), but
there are plenty of other things you'd probably like to do with your build
scripts.</p>
<h3 id="implicit-conversions">Implicit conversions</h3>
<p>bfg9000 tries its best to make your build scripts easy to read and to minimize
verbosity. First, arguments that normally take a list can take a single item
instead, e.g. <code>executable('simple', files='simple.cpp')</code>. In addition, bfg9000
will automatically convert a string argument to an object of the appropriate
type. In the previous example, <code>'simple.cpp'</code> is automatically converted to a
<a href="../reference/#source_filename-lang"><em>source_file</em></a>.</p>
<h3 id="sudirectories">Sudirectories</h3>
<p>Many projects organize their headers and source files into different
directories. For source files, this is easy to handle: just write out the
relative path to the file. For header files, you need to let your compiler know
where they're located. The
<a href="../reference/#header_directoryname-system"><em>header_directory</em></a> function creates
a reference to the directory, which can then be passed to your build function
via the <em>include</em> argument:</p>
<pre><code class="python">include_dir = header_directory('include')
executable('program', files=['src/prog.cpp'], include=[include_dir])
</code></pre>

<p>As noted above, you can also simplify this to:</p>
<pre><code class="python">executable('program', files='src/prog.cpp', include='include')
</code></pre>

<p>Of course, bfg9000 also allows you to place built files in subdirectories as
well. Simply specify the relative path as the name of executable (or whatever
type of file you're building).</p>
<h3 id="options">Options</h3>
<p>Build scripts often need to set options when compiling/linking binaries.
Sometimes, these are specific to a single executable in the project, and other
times they apply to <em>all</em> the binaries. bfg9000 supports both cases. You can
provide options for a single binary with the <em>compile_options</em> and
<em>link_options</em> arguments:</p>
<pre><code class="python">executable('simple', files=['simple.cpp'], compile_options=['-Wall', '-Werror'],
           link_options=['-static-libstdc++'])
</code></pre>

<p>You can also specify <a href="../reference/#global_optionsoptions-lang">global compiler
options</a> (on a per-language basis) as
well as <a href="../reference/#global_link_optionsoptions">global linker options</a>:</p>
<pre><code class="python">global_options(['-Wall', '-Werror'], lang='c++')
global_link_options(['-static-libstdc++'])
</code></pre>

<p>Naturally, the interpretations of these arguments depend on the compiler being
used, so it's important to be sure the compiler understands the arguments. You
can determine the kind of compiler being used by consulting the build's
<a href="../reference/#environment">Environment</a> and checking the compiler's
<a href="../reference/#compilerflavor"><em>flavor</em></a>.</p>
<h2 id="building-libraries">Building libraries</h2>
<p>Similar to building executables, you can also build
<a href="../reference/#shared_libraryname-files-extra_deps">shared</a> and
<a href="../reference/#static_libraryname-files-extra_deps">static</a> libraries. These take
the same arguments as above, although static libraries have no use for the
<em>link_options</em> argument.</p>
<p>Once you've defined rules to build a library, you can pass it along to an
executable or other shared library via the <em>libs</em> argument:</p>
<pre><code class="python">shared = shared_library('shared', files=['shared.cpp'])
static = static_library('shared', files=['static.cpp'])
executable('program', files=['program.cpp'], libs=[shared, static])
</code></pre>

<h2 id="default-build">Default build</h2>
<p>When you're building multiple binaries, you might want to be able to specify
what gets built by default, i.e. when calling <code>make</code> (or <code>ninja</code>) with no
arguments. Normally, every executable and library (except those passed to
<a href="../reference/#testtest-options-environmentdriver"><em>test()</em></a>) will get built.
However, you can pass any build rule(s) to <a href="../reference/#default"><em>default()</em></a>,
and they'll be set as the default, overriding the normal behavior. This makes it
easy to provide your users with a standard build that gets them all the bits
they need, and none they don't.</p>
<h2 id="external-packages">External packages</h2>
<h2 id="installation">Installation</h2>
<h2 id="commands">Commands</h2>
<h2 id="aliases">Aliases</h2>
<h2 id="tests">Tests</h2>
<h2 id="finding-files">Finding files</h2></div>
        </div>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
    </body>
</html>